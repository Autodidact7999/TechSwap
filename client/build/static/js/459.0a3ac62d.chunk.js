"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[459],{8459:(e,t,r)=>{r.r(t),r.d(t,{default:()=>f});var a=r(5043),s=r(3216),n=r(9456),l=r(4248),c=r(7796),i=r(7805),d=r(2127),o=r(221),m=r(579);const x=e=>{let{activeTab:t,handleTabClick:r}=e;const x=(0,s.Zp)(),u=(0,n.wA)(),[h,g]=(0,a.useState)(!1);return(0,m.jsx)("div",{className:"border-b border-gray-200 sticky top-0 left-0 z-30 bg-white rounded-md",children:(0,m.jsxs)("ul",{className:"flex flex-wrap -mb-px text-sm font-medium text-center text-gray-500",children:[(0,m.jsx)("li",{className:"mr-2 flex items-center",children:(0,m.jsxs)("span",{className:"cursor-pointer inline-flex items-center px-2 py-2 border-b-2 rounded-t-lg ".concat("logs"===t?"border-blue-500 bg-primary rounded-md text-white":"border-transparent hover:text-gray-600 hover:border-gray-300"),onClick:()=>r("logs"),children:[(0,m.jsx)(d.ICT,{className:"mr-1"}),"Logs"]})}),(0,m.jsx)("li",{className:"mr-2 flex items-center",children:(0,m.jsxs)("span",{className:"cursor-pointer inline-flex items-center px-2 py-2 border-b-2 rounded-t-lg ".concat("settings"===t?"border-blue-500 bg-primary rounded-md text-white":"border-transparent hover:text-gray-600 hover:border-gray-300"),onClick:()=>r("settings"),children:[(0,m.jsx)(o.GD,{className:"mr-1"}),"Settings"]})}),(0,m.jsx)("li",{className:"mr-2 flex items-center",children:(0,m.jsxs)("span",{className:"cursor-pointer inline-flex items-center px-2 py-2 border-b-2 rounded-t-lg ".concat("Community Management"===t?"border-blue-500 bg-primary rounded-md text-white":"border-transparent hover:text-gray-600 hover:border-gray-300"),onClick:()=>r("Community Management"),children:[(0,m.jsx)(d.jh0,{className:"mr-1"}),"Community Management"]})}),(0,m.jsx)("li",{className:"mr-2 flex items-center",children:(0,m.jsxs)("span",{className:"cursor-pointer inline-flex items-center px-2 py-2 border-b-2 rounded-t-md ".concat("logout"===t?"border-blue-500 bg-primary rounded-md text-white":"border-transparent hover:text-red-600 hover:border-red-600"),onClick:async()=>{g(!0),await u((0,l.Zm)()).then((()=>{x("/admin/signin")})),g(!1)},children:[(0,m.jsx)(i.AMx,{className:"mr-1"}),(0,m.jsx)("span",{className:"".concat("logout"===t?"group-hover:text-gray-500":"group-hover:text-red-600"),children:h?(0,m.jsx)(c.A,{loadingText:"Logging out..."}):"Logout"})]})})]})})},u=()=>{const[e,t]=(0,a.useState)((new Date).toLocaleString());(0,a.useEffect)((()=>{const e=setInterval((()=>{t((new Date).toLocaleString())}),1e3);return()=>clearInterval(e)}),[]);const r=new Date(e),s=r.toLocaleDateString("en-US",{weekday:"long"}),n=r.toLocaleDateString("en-US",{month:"long"}),l=r.toLocaleDateString("en-US",{day:"numeric"}),c=r.toLocaleDateString("en-US",{year:"numeric"}),i=r.getHours()%12||12,d=r.getMinutes().toString().padStart(2,"0"),o=r.getSeconds().toString().padStart(2,"0"),x=r.getHours()>=12?"PM":"AM",u="".concat(i,":").concat(d,":").concat(o," ").concat(x);return(0,m.jsx)("div",{className:"text-sm text-gray-800 mt-1",children:"".concat(s,", ").concat(n," ").concat(l,", ").concat(c," ").concat(u)})};var h=r(9719),g=r(243);const y=()=>{const[e,t]=(0,a.useState)(!0),[r,s]=(0,a.useState)(!1),i=(0,n.wA)(),d=(0,n.d4)((e=>{var t;return null===(t=e.admin)||void 0===t?void 0:t.logs})),o=async()=>{try{t(!0),await i((0,l.C1)())}finally{t(!1)}};return(0,a.useEffect)((()=>{o()}),[null===d||void 0===d?void 0:d.length]),e||!d?(0,m.jsx)("div",{className:"flex items-center justify-center mt-5",children:(0,m.jsx)(h.A,{})}):(0,m.jsx)("div",{className:"bg-white flex flex-col items-center justify-center mt-3 rounded-md",children:(0,m.jsxs)("div",{className:"p-4 shadow-md rounded relative xl:min-w-[1200px] lg:min-w-[1000px] md:min-w-[800px]",children:[(0,m.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,m.jsx)("h1",{className:"text-2xl font-bold text-gray-800",children:"User Activity Logs"}),(0,m.jsx)(u,{})]}),(0,m.jsxs)("div",{className:"flex justify-between items-center mb-4 border-b border-gray-200 pb-2",children:[(0,m.jsx)("div",{className:"text-sm italic text-gray-600",children:"Showing ".concat(d.length," items from the last 7 days")}),(0,m.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,m.jsx)("button",{onClick:async()=>{try{t(!0),await o()}catch(e){}},children:(0,m.jsx)(g.l_n,{})}),(0,m.jsx)("button",{className:"bg-blue-500 text-white text-sm py-2 px-4 rounded hover:bg-blue-700 ".concat(r?"opacity-50 cursor-not-allowed":""," ").concat(0===d.length?"hidden":""),onClick:async()=>{try{s(!0),await i((0,l.JT)())}finally{s(!1)}},disabled:r||0===d.length,children:r?(0,m.jsx)(c.A,{loadingText:"Clearing..."}):"Clear Logs"})]})]}),e?null:0===d.length?(0,m.jsx)("div",{className:"text-gray-500 text-lg",children:"No logs found"}):(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("div",{className:"h-[430px] relative overflow-auto",children:(0,m.jsxs)("div",{className:"w-full rounded",children:[(0,m.jsxs)("div",{className:"grid grid-cols-5 gap-5 items-center border-b py-2 font-semibold text-gray-800",children:[(0,m.jsx)("p",{className:"text-center",children:"Timestamp"}),(0,m.jsx)("p",{children:"Message"}),(0,m.jsx)("p",{children:"Email Used"}),(0,m.jsx)("p",{children:"Level"}),(0,m.jsx)("p",{children:"Context Data"})]}),d.map((e=>(0,m.jsxs)("div",{className:"grid grid-cols-5 gap-5 items-center border-b py-2 text-sm text-gray-700",children:[(0,m.jsxs)("span",{className:"flex-col justify-center items-center text-center font-mono",children:[(0,m.jsx)("p",{children:e.relativeTimestamp}),(0,m.jsx)("p",{className:"text-xs",children:e.formattedTimestamp})]}),(0,m.jsxs)("td",{className:"".concat("info"===e.level?"text-blue-500":"warn"===e.level?"text-orange-500":"error"===e.level?"text-red-600":""),children:[(0,m.jsxs)("span",{className:"capitalize",children:[e.type,": "]}),(0,m.jsx)("span",{children:e.message})]}),(0,m.jsx)("p",{children:e.email}),(0,m.jsx)("td",{className:"",children:(0,m.jsx)("span",{className:"rounded-full px-2 py-1 text-sm font-semibold ".concat("error"===e.level?"bg-red-500 text-white":"warn"===e.level?"bg-orange-500 text-white":"bg-blue-500 text-white"),children:e.level})}),(0,m.jsx)("td",{className:"",children:(0,m.jsx)("ul",{className:"list-disc list-inside",children:e.contextData&&Object.entries(e.contextData).map((e=>{let[t,r]=e;return(0,m.jsxs)("li",{children:[(0,m.jsxs)("span",{className:"font-medium text-blue-500",children:[t,":"," "]}),r]},t)}))})})]},e._id)))]})}),(0,m.jsx)("div",{className:"flex justify-center text-sm italic text-gray-600 mt-2",children:"logs are automatically deleted after 7 days"})]})]})})},p=()=>{const e=(0,n.wA)(),[t,r]=(0,a.useState)(!0),[s,c]=(0,a.useState)(!1),[i,d]=(0,a.useState)(!1),o=(0,n.d4)((e=>{var t;return null===(t=e.admin)||void 0===t?void 0:t.servicePreferences})),[x,u]=(0,a.useState)(!1),[h,g]=(0,a.useState)(""),[y,p]=(0,a.useState)(0);(0,a.useEffect)((()=>{e((0,l.C$)())}),[e]),(0,a.useEffect)((()=>{o&&(u(o.usePerspectiveAPI),g(o.categoryFilteringServiceProvider),p(o.categoryFilteringRequestTimeout),r(!1))}),[o]);return t||!o?(0,m.jsx)("div",{children:"Loading..."}):(0,m.jsxs)("div",{className:"p-5 w-full border rounded-md bg-white mt-3",children:[(0,m.jsx)("h2",{className:"font-semibold mb-4 border-b pb-2 text-center text-gray-700",children:"Service Preferences"}),i&&(0,m.jsx)("div",{className:"bg-green-100 text-green-800 p-2 mb-4 rounded",children:"Service Preferences updated successfully!"}),(0,m.jsxs)("div",{className:"flex items-center mb-4",children:[(0,m.jsx)("div",{children:"Use Perspective API for content moderation"}),(0,m.jsx)("div",{className:"ml-auto",children:(0,m.jsx)("input",{className:"w-5 h-5 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600",type:"checkbox",checked:x,onChange:e=>u(e.target.checked)})})]}),(0,m.jsxs)("div",{className:"flex items-center mb-4",children:[(0,m.jsx)("div",{children:"Category filtering service provider"}),(0,m.jsx)("div",{className:"ml-auto",children:(0,m.jsxs)("select",{className:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 ",value:h,onChange:e=>g(e.target.value),children:[(0,m.jsx)("option",{value:"",children:"Select a provider"}),(0,m.jsx)("option",{value:"TextRazor",children:"TextRazor"}),(0,m.jsx)("option",{value:"InterfaceAPI",children:"InterfaceAPI"}),(0,m.jsx)("option",{value:"ClassifierAPI",children:"ClassifierAPI"}),(0,m.jsx)("option",{value:"disabled",children:"Disabled"})]})})]}),(0,m.jsxs)("div",{className:"flex items-center mb-4",children:[(0,m.jsx)("div",{children:"Category filtering request timeout (ms)"}),(0,m.jsx)("div",{className:"ml-auto",children:(0,m.jsx)("input",{className:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 ",type:"number",value:y,min:0,max:5e5,required:!0,onChange:e=>{p(e.target.value)}})})]}),(0,m.jsx)("div",{className:"flex justify-end",children:(0,m.jsx)("button",{className:"bg-blue-500 text-white px-4 py-2 rounded disabled:opacity-50",onClick:async()=>{c(!0),d(!1);try{await e((0,l.vX)({usePerspectiveAPI:x,categoryFilteringServiceProvider:h,categoryFilteringRequestTimeout:y})),d(!0),setTimeout((()=>{d(!1)}),3e3)}finally{c(!1)}},disabled:s,children:s?"Updating...":"Update"})})]})},b=()=>{var e,t,r,s;const c=(0,n.wA)(),i=(0,n.d4)((e=>{var t;return null===(t=e.admin)||void 0===t?void 0:t.communities})),d=(0,n.d4)((e=>{var t;return null===(t=e.admin)||void 0===t?void 0:t.moderators})),o=(0,n.d4)((e=>{var t;return null===(t=e.admin)||void 0===t?void 0:t.community}));(0,a.useEffect)((()=>{c((0,l.WB)()),c((0,l.vT)())}),[c]);const[x,u]=(0,a.useState)(null),[h,g]=(0,a.useState)(null),[y,p]=(0,a.useState)(null),[b,f]=(0,a.useState)(""),[v,j]=(0,a.useState)(!1),[w,N]=(0,a.useState)(!1);(0,a.useEffect)((()=>{g(o)}),[o]);return i&&d?(0,m.jsxs)("div",{className:"flex gap-2 h-[85vh] w-full mt-3 border rounded-md",children:[(0,m.jsxs)("div",{className:"flex flex-col w-full bg-white shadow-inner rounded-md border-r",children:[(0,m.jsx)("h1",{className:"text-lg font-bold p-4 text-center border-b-2",children:"Communities"}),(0,m.jsx)("div",{className:"flex flex-col overflow-y-auto",children:i.map((e=>(0,m.jsxs)("div",{className:"p-4 cursor-pointer hover:bg-background border-b flex items-center ".concat((null===x||void 0===x?void 0:x._id)===e._id?"bg-gray-200":""),onClick:()=>(async e=>{u(e),N(!0),await c((0,l.qn)(e._id)),N(!1)})(e),children:[(0,m.jsx)("img",{src:e.banner,alt:e.name,className:"w-10 h-10 rounded-full mr-2 md:mr-4"}),(0,m.jsx)("span",{className:"text-gray-700 text-xs md:text-base",children:e.name})]},e._id)))})]}),(0,m.jsx)("div",{className:"flex flex-col w-full bg-white rounded-md px-5 py-5 border-l",children:w?(0,m.jsx)("div",{className:"flex justify-center items-center h-screen",children:(0,m.jsx)("span",{className:"admin-loader"})}):h?(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("h1",{className:"font-bold text-lg border-b border-black pb-1 mb-2",children:h.name}),v&&(0,m.jsx)("div",{className:"bg-green-100 text-green-800 p-2 mb-4 rounded",children:"Updating..."}),(0,m.jsxs)("span",{className:"text-sm",children:["Total Moderators: ",h.moderatorCount]}),(0,m.jsxs)("span",{className:"text-sm",children:["Total Members: ",h.memberCount]}),(0,m.jsxs)("div",{className:"flex flex-col md:flex-row gap-5",children:[(0,m.jsxs)("div",{className:"flex flex-col gap-2 w-full md:w-1/2",children:[(0,m.jsx)("h2",{className:"font-medium mb-2",children:"Moderators"}),0===(null===(e=h.moderators)||void 0===e?void 0:e.length)&&(0,m.jsx)("span",{children:"No moderators"}),(0,m.jsx)("div",{className:"flex flex-col",children:null===(t=h.moderators)||void 0===t?void 0:t.map((e=>(0,m.jsxs)("div",{className:"p-2 cursor-pointer border flex flex-col md:flex-row gap-2 justify-between items-center rounded ".concat((null===y||void 0===y||y._id,e._id,"")),onClick:()=>(e=>{p(e)})(e),children:[(0,m.jsx)("span",{className:"font-medium",children:e.name}),(0,m.jsx)("button",{disabled:v,className:" bg-red-500 px-4 py-1 text-sm  text-white rounded hover:bg-red-700 ".concat(v?"opacity-50 cursor-not-allowed":""),onClick:()=>(async e=>{j(!0),await c((0,l.KX)(h._id,e._id)),await c((0,l.qn)(h._id)),await c((0,l.rb)(h._id,b)),await c((0,l.vT)()),j(!1)})(e),children:"Remove"})]},e._id)))})]}),(0,m.jsxs)("div",{className:"flex flex-col w-full gap-2 md:w-1/2",children:[(0,m.jsx)("h2",{className:"font-medium mb-2",children:"Add Moderator"}),(0,m.jsxs)("div",{className:"flex flex-col gap-2 md:flex-row",children:[(0,m.jsxs)("select",{className:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 ",value:b,onChange:e=>f(e.target.value),children:[(0,m.jsx)("option",{value:"",children:"Select a moderator"}),null===d||void 0===d?void 0:d.map((e=>(0,m.jsx)("option",{value:e._id,children:e.name},e._id)))]}),(0,m.jsx)("button",{disabled:!b||v||(null===(r=h.moderators)||void 0===r?void 0:r.find((e=>e._id===b))),className:"p-2 bg-blue-500 text-white rounded hover:bg-blue-700 ".concat(!b||v||null!==(s=h.moderators)&&void 0!==s&&s.find((e=>e._id===b))?"opacity-50 cursor-not-allowed":""),onClick:async()=>{j(!0),await c((0,l.rb)(h._id,b)),await c((0,l.qn)(h._id)),await c((0,l.vT)()),f(""),j(!1)},children:"Add"})]})]})]})]}):(0,m.jsx)("div",{className:"flex flex-col items-center justify-center h-full",children:(0,m.jsx)("span",{className:"font-medium text-gray-400",children:"Select a community to view details"})})})]}):(0,m.jsx)("div",{children:"Loading..."})},f=()=>{const e=(0,n.wA)(),t=(0,s.Zp)(),[r,c]=(0,a.useState)("logs"),i=(0,n.d4)((e=>{var t;return null===(t=e.admin)||void 0===t?void 0:t.adminPanelError}));return(0,a.useEffect)((()=>{"Unauthorized"===i&&e((0,l.Zm)()).then((()=>{t("/admin/signin")}))}),[i,e,t]),(0,m.jsxs)("div",{className:"pt-5 max-w-6xl mx-auto flex flex-col justify-center items-center ",children:[(0,m.jsx)(x,{activeTab:r,handleTabClick:e=>{c(e)}}),"logs"===r&&(0,m.jsx)(y,{}),"settings"===r&&(0,m.jsx)(p,{}),"Community Management"===r&&(0,m.jsx)(b,{})]})}},4248:(e,t,r)=>{r.d(t,{rb:()=>h,JT:()=>i,WB:()=>m,qn:()=>x,C1:()=>c,vT:()=>u,C$:()=>d,Zm:()=>l,KX:()=>g,Lz:()=>n,vX:()=>o});var a=r(2247);var s=r(4359);const n=e=>async t=>{try{const{error:r,data:n}=await(async e=>{try{return console.log("AdminAPI ",a.lb),console.log("Credential ",e),{error:null,data:(await a.lb.post("/signin",e)).data}}catch(r){return(0,a.hS)(r)}})(e);if(r)throw new Error(r);localStorage.setItem("admin",JSON.stringify(n)),t({type:s.qf})}catch(r){t({type:s.Xm,payload:r.message})}},l=()=>async e=>{try{localStorage.removeItem("admin"),e({type:s.l3})}catch(t){}},c=()=>async e=>{try{const{error:t,data:r}=await(async()=>{try{return{error:null,data:(await a.lb.get("/logs")).data}}catch(t){return(0,a.hS)(t)}})();if(t)throw new Error(t);e({type:s.Ho,payload:r})}catch(t){e({type:s.Sw,payload:t.message})}},i=()=>async e=>{try{const{error:t}=await(async()=>{try{await a.lb.delete("/logs")}catch(t){return(0,a.hS)(t)}})();if(t)throw new Error(t);e({type:s.AJ})}catch(t){e({type:s.PR,payload:t.message})}},d=()=>async e=>{try{const{error:t,data:r}=await(async()=>{try{return{error:null,data:(await a.lb.get("/preferences")).data}}catch(t){return(0,a.hS)(t)}})();if(t)throw new Error(t);e({type:s.Wp,payload:r})}catch(t){e({type:s.Nz,payload:t.message})}},o=e=>async t=>{try{const{error:r}=await(async e=>{try{await a.lb.put("/preferences",e)}catch(r){return(0,a.hS)(r)}})(e);if(r)throw new Error(r);t({type:s.dK})}catch(r){t({type:s.Ek,payload:r.message})}},m=()=>async e=>{try{const{error:t,data:r}=await(async()=>{try{return{error:null,data:(await a.lb.get("/communities")).data}}catch(t){return(0,a.hS)(t)}})();if(t)throw new Error(t);e({type:s.pK,payload:r})}catch(t){e({type:s.YI,payload:t.message})}},x=e=>async t=>{try{const{error:r,data:n}=await(async e=>{try{return{error:null,data:(await a.lb.get("/community/".concat(e))).data}}catch(r){return(0,a.hS)(r)}})(e);if(r)throw new Error(r);t({type:s.rR,payload:n})}catch(r){t({type:s.OF,payload:r.message})}},u=()=>async e=>{try{const{error:t,data:r}=await(async()=>{try{return{error:null,data:(await a.lb.get("/moderators")).data}}catch(t){return(0,a.hS)(t)}})();if(t)throw new Error(t);e({type:s.qK,payload:r})}catch(t){e({type:s.H9,payload:t.message})}},h=(e,t)=>async r=>{try{const{error:n}=await(async(e,t)=>{try{await a.lb.patch("/add-moderators",null,{params:{communityId:e,moderatorId:t}})}catch(n){return(0,a.hS)(n)}})(e,t);if(n)throw new Error(n);r({type:s.G4})}catch(n){r({type:s.JE,payload:n.message})}},g=(e,t)=>async r=>{try{const{error:n}=await(async(e,t)=>{try{await a.lb.patch("/remove-moderators",null,{params:{communityId:e,moderatorId:t}})}catch(n){return(0,a.hS)(n)}})(e,t);if(n)throw new Error(n);r({type:s.lu})}catch(n){r({type:s.Sj,payload:n.message})}}}}]);
//# sourceMappingURL=459.0a3ac62d.chunk.js.map